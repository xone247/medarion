# Commands to Fix Port 38660 Conflict
# Copy and paste these in your Jupyter terminal

# Step 1: Find what's using port 38660
lsof -i :38660

# OR if lsof doesn't work:
netstat -tuln | grep :38660

# OR:
ss -tuln | grep :38660

# Step 2: Kill the process using port 38660
# Option A (if you see a PID from lsof):
kill -9 $(lsof -ti :38660)

# Option B (using fuser):
fuser -k 38660/tcp

# Option C (manual - if you see PID 12345, replace with actual PID):
# kill -9 12345

# Step 3: Verify port is free
lsof -i :38660
# Should return nothing

# Step 4: Start API in background
cd /workspace
nohup python3 run_api_on_vast.py > api.log 2>&1 &

# Step 5: Check if it started
ps aux | grep 'python3 run_api_on_vast.py' | grep -v grep

# Step 6: Check logs
tail -20 api.log

# Step 7: Test
curl http://localhost:38660/health

