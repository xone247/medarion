# Start API and Verify - Run in Jupyter Terminal

# 1. Check if API is running
ps aux | grep 'python3.*run_api_on_vast.py' | grep -v grep

# 2. If not running, start it
cd /workspace && nohup python3 run_api_on_vast.py > api.log 2>&1 &

# 3. Wait for model to load (30-60 seconds)
sleep 30

# 4. Check if it's running
ps aux | grep 'python3.*run_api_on_vast.py' | grep -v grep

# 5. Test internal endpoint
curl http://localhost:44047/health

# Expected: {"status":"ok","model":"Mistral-7B"}

# 6. Check logs if needed
tail -30 /workspace/api.log

# 7. Test public tunnel URL (from your PC)
curl https://chance-episode-hansen-park.trycloudflare.com/health

# If you get 502, the API might still be loading the model
# Wait a bit longer and try again

